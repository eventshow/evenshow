{%extends 'base.html'%}
{% load static %}


{% block content %}
<div class="container">
  <div class="title-share">
    <div class="col s12">
      <h3 class="flow-text" id="name-host-serg">Ofrece una experiencia</h3>
    </div>
  </div>
</div>

<div class="container">
  <form class="form-eventshow" id="create-event" method="post" action="{% url 'create_event' %}">
    {% csrf_token %}
    <div class="row">
      <div class="col s12">
        <h4 class="flow-text" id="name-host-serg">¿Qué quieres compartir?</h4>
      </div>
    </div>
    <div class="row">
      <div class="grid-example col s12">
        <ul class="tabs">
          <li class="tab col s4"><a class="active" href="#test1">¿Cómo será?</a></li>
          <li class="tab col s4"><a href="#test2">¿Cuándo será?</a></li>
          <li class="tab col s4"><a href="#test3">Extra</a></li>
        </ul>
      </div>
    </div>


    <div id="test1" class="tab-content">
      <label>CATEGORÍA</label>
      <div class="row">
        <div class="grid-example col s12">
          <div class="form-errors">
            {{ form.category }}
          </div>
        </div>
      </div>

      <div class="row">
        <div class="grid-example col s12">
          <label>TÍTULO</label>
           {{ form.title }}
          <div class="form-errors">
            {{ form.title.errors }}
          </div>
        </div>
      </div>

      <div class="row">
        <div class="grid-example col s12">
          <label>DESCRIPCIÓN</label>
          {{ form.description }}
        </div>
      </div>
      <div class="row">
        <div class="grid-example col s4">
          <label>AFORO</label>
            {{ form.capacity }}
          <div class="form-errors">
            {{ form.capacity.errors }}
          </div>
        </div>
        <div class="grid-example col s4">
          <label>EDAD MÍN</label>
            {{ form.min_age }}
          <div class="form-errors">
            {{ form.min_age.errors }}
          </div>
        </div>
        <div class="grid-example col s4">
          <label>PRECIO</label>
            {{ form.price }}
          <div class="form-errors">
            {{ form.price.errors }}
          </div>
        </div>
      </div>
    </div>

    <div id="test2" class="tab-content">
      <div class="row">
        <div class="grid-example col s12">
          <label>UBICACIÓN</label>
            {{ form.location_city }}
          <div class="form-errors">
            {{ form.location_city.errors }}
          </div>
            {{ form.location_street }}
          <div class="form-errors">
            {{ form.location_street.errors }}
          </div>
            {{ form.location_number }}
          <div class="form-errors">
            {{ form.location_number.errors }}
          </div>
        </div>
      </div>
      <div class="row">
        <div class="grid-example col s4">
          <label>FECHA</label>
            {{form.start_day}}
          <div class="form-errors">
            {{ form.start_day.errors }}
          </div>
        </div>
        <div class="grid-example col s4">
          <label>HORA INICIO</label>
            {{form.start_time}}
          <div class="form-errors">
            {{ form.start_time.errors }}
          </div>
        </div>
        <div class="grid-example col s4">
          <label>HORA FIN</label>
            {{form.end_time}}
          <div class="form-errors">
            {{ form.end_time.errors }}
          </div>
        </div>

      </div>

    </div>


    <div id="test3" class="tab-content">

      <div class="row">
        <div class="grid-example col s4">
          <label>MASCOTAS</label>
            {{ form.pets }}
          <div class="form-errors">
            {{ form.pets.errors }}
          </div>
        </div>
        <div class="grid-example col s4">
          <label>IDIOMA</label>
            {{ form.lang }}
          <div class="form-errors">
            {{ form.lang.errors }}
          </div>
        </div>
        <div class="grid-example col s4">
          <label>APARCAMIENTO</label>
          {{ form.parking_nearby }}
          <div class="form-errors">
            {{ form.parking_nearby.errors }}
          </div>
        </div>
        <div class="grid-example col s12">
          <label>IMAGEN DEL EVENTO</label>
            {{ form.picture }}
          <div class="form-errors">
            {{ form.picture.errors }}
          </div>
        </div>
        <div class="grid-example col s12">
          <label>INFORMACIÓN EXTRA PARA EL ASISTENTE</label>
          {{ form.extra_info }}
          <div class="form-errors">
            {{ form.extra_info.errors }}
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="grid-example col s6 offset-s5">
        <div class="delete-buttons">
          <button class="waves-effect waves-light btn-large" id="prevBtn" onclick="nextPrev(-1)">Anterior</button>
          <button class="waves-effect waves-light btn-large" id="nextBtn" onclick="nextPrev(1)">Siguiente</button>
        </div>
      </div>

    </div>
    <div class="form-errors">
      {{ form.errors }}
    </div>
    <div style="text-align:center;margin-top:40px;">
      <span class="step"></span>
      <span class="step"></span>
      <span class="step"></span>
      <span class="step"></span>
    </div>
  </form>
</div>

<script>
  $(document).ready(function () {
    $('ul.tabs').tabs();
  });
  $(document).ready(function () {
    $('ul.tabs').tabs('select_tab', 'tab_id');
  });
  var currentTab = 0; // Current tab is set to be the first tab (0)
  showTab(currentTab); // Display the current tab

  function showTab(n) {
    // This function will display the specified tab of the form ...
    var x = document.getElementsByClassName("tab-content");
    x[n].style.display = "block";
    // ... and fix the Previous/Next buttons:
    if (n == 0) {
      document.getElementById("prevBtn").style.display = "none";
    } else {
      document.getElementById("prevBtn").style.display = "inline";
      document.getElementById("nextBtn").style.marginTop = "-20%";
    }
    if (n == (x.length - 1)) {
      document.getElementById("nextBtn").innerHTML = "Enviar";
    } else {
      document.getElementById("nextBtn").innerHTML = "Siguiente";
      document.getElementById("nextBtn").style.marginLeft = "40%";
    }
    // ... and run a function that displays the correct step indicator:
    fixStepIndicator(n)
  }

  function nextPrev(n) {
    // This function will figure out which tab to display
    var x = document.getElementsByClassName("tab-content");
    // Exit the function if any field in the current tab is invalid:
    if (n == 1 && !validateForm()) return false;
    // Hide the current tab:
    x[currentTab].style.display = "none";
    // Increase or decrease the current tab by 1:
    currentTab = currentTab + n;
    // if you have reached the end of the form... :
    if (currentTab >= x.length) {
      //...the form gets submitted:
      document.getElementById("create-event").submit();
      return false;
    }
    // Otherwise, display the correct tab:
    showTab(currentTab);
  }

  function validateForm() {
    // This function deals with validation of the form fields
    var x, y, i, valid = true;
    x = document.getElementsByClassName("tab-content");
    y = x[currentTab].getElementsByTagName("input");
    // A loop that checks every input field in the current tab:
    for (i = 0; i < y.length; i++) {
      // If a field is empty...
      if (y[i].value == "") {
        // add an "invalid" class to the field:
        y[i].className += " invalid";
        // and set the current valid status to false:
        valid = false;
      }
    }
    // If the valid status is true, mark the step as finished and valid:
    if (valid) {
      document.getElementsByClassName("step")[currentTab].className += " finish";
    }
    return valid; // return the valid status
  }

  function fixStepIndicator(n) {
    // This function removes the "active" class of all steps...
    var i, x = document.getElementsByClassName("step");
    for (i = 0; i < x.length; i++) {
      x[i].className = x[i].className.replace(" active", "");
    }
    //... and adds the "active" class to the current step:
    x[n].className += " active";
    M.Tabs.getInstance(elem).updateTabIndicator().destroy();
  }

  $(document).ready(function () {
    $('.datepicker').datepicker();
  });
</script>
{% endblock %}