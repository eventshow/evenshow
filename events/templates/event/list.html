{%extends 'base.html' %}
{% block content %}
<style>
  body {

    background-size: cover;
    display: flex;
    min-height: 100vh;
    flex-direction: column;
  }

  main {
    flex: 1 0 auto;
  }

  .page-footer {
    width: 100%;
  }
</style>
<div class="container">
  <div class="titulo">
    <div class="col s12">
      <h3 class="name-host">Experiencias siendo {{role}}</h3>
    </div>
  </div>
  <div class="table-generic">
    <table summary="" cellpadding="1" cellspacing="1" class="responsive-table" id="myTable">
      <thead>
        <tr>
          {% if role == "huésped" %}
          <th id="">Puntuar</th>
          <th id="">Título</th>
          <th id="">Fecha</th>
          <th id="">Dirección</th>
          <th id="">Acciones</th>
          {% else %}
          <th id="">Título</th>
          <th id="">Fecha</th>
          <th id="">Dirección</th>
          <th id="">Acciones</th>
          {% endif %}
        </tr>
      </thead>
      {% for event in object_list %}
      <tbody>
        <tr>
          {% if role == "huésped" %}
          <td>
            {% if event not in user_rated_events and event.has_finished %}
            {% if not event in enroll_valid %}
            <p class="request-fail">Su solicitud no ha sido aceptada</p>
            {% endif%}
            {% if event in enroll_valid %}
            <button type="button" onclick="location.href='{% url 'create_rating_host' event.pk %}'" title="Puntuar">
              <em id="title-name" class="samll material-icons">star</em>
            </button>
            {% endif%}
            {% elif event in user_rated_events %}
            Ya puntuado
            {% elif not event.has_started%}
            No ha empezado
            {% elif not event.has_finished%}
            No ha terminado
            {% endif %}
          </td>
          {% endif %}
          <td><strong><a href="{% url 'detail_event' event.pk %}">{{event.title}}</a></strong></td>
          <td>{{event.start_day}}</td>
          <td> {{event.location_city}}, {{event.location_street}}, {{event.location_number}}</td>
          <td>
            {% if role == "huésped" %}
            {% if not event.has_started %}
            <form action="{% url 'delete_enrollment' event.pk %}" method="POST">
              {% csrf_token %}
              <button type="submit" class="waves-effect waves-light btn" title="Ya no quiero ir" name="ya_no"
                id="yaNo">Ya no quiero ir</button>
            </form>
            {% elif event.has_finished %}
            Ya ha acabado
            {% elif event.has_started %}
            Ya ha empezado
            {% endif %}
            {% else %}
            <button type="button" onclick="location.href='{% url 'list_attendees' event.pk %}'"
              title="Lista de asistentes"> <em id="title-name" class="small material-icons">people</em></button>
            <button type="button" onclick="location.href='{% url 'attendee_payment' event.pk %}'" title="Cobrar">
              <em id="title-name" class="small material-icons">attach_money</em></button>
            {% if not event.has_started %}
            <button type="button" onclick="location.href='{% url 'update_event' event.pk %}'" title="Editar"> <i
                id="title-name" class="small material-icons">edit</i></button>
            <button type="button" onclick="location.href='{% url 'list_enrollments' event.pk %}'"
              title="Añadir sistentes"> <em id="title-name" class="small material-icons">group_add</em> </button>
            <button type="button" onclick="location.href='{% url 'delete_event' event.pk %}'" title="Eliminar">
              <em id="title-name" class="small material-icons">delete</em></button>
            {% endif %}
            {% endif %}
          </td>
        </tr>
      </tbody>
      {% endfor %}
    </table>
    {% include "pagination.html" %}
  </div>
</div>
{% endblock %}